<div class="p-6 bg-gray-50 min-h-screen">
    @if (isLoading) {
        <app-loading-spinner message="Obteniendo tu resumen académico..."></app-loading-spinner>
    } @else {
    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">

        <section class="bg-white rounded-2xl shadow-sm p-6 col-span-1 md:col-span-2 border border-gray-100">
            <div class="flex justify-between items-center mb-5">
                <h2 class="font-bold text-lg text-[#002940]">Mis Cursos y Notas</h2>
                <a href="/estudiante/cursos" class="text-sm font-semibold text-[#0B4D6C] hover:underline flex items-center gap-1">
                    Ver más <i class="fa-solid fa-arrow-right text-xs"></i>
                </a>
            </div>
            
            <div class="grid gap-4">
                @if (data.cursos && data.cursos.length > 0) {
                    @for (curso of data.cursos; track $index) {
                        <div class="flex justify-between items-center p-4 border border-gray-100 rounded-xl hover:shadow-md transition bg-gray-50">
                            <div class="flex items-center gap-4">
                                <div class="h-10 w-10 rounded-lg bg-blue-100 text-[#0B4D6C] flex items-center justify-center font-bold">
                                    {{ curso.siglas }}
                                </div>
                                <div>
                                    <p class="font-semibold text-gray-800">{{ curso.nombre }}</p>
                                    <span [class]="curso.modalidad === 'Virtual' ? 'bg-yellow-100 text-yellow-700' : 'bg-green-100 text-green-700'" 
                                          class="text-xs px-2 py-0.5 rounded-full font-medium">
                                        {{ curso.modalidad }}
                                    </span>
                                </div>
                            </div>
                            <span class="text-xl font-bold text-[#0B4D6C]">{{ curso.promedio }}</span>
                        </div>
                    }
                } @else {
                    <div class="text-center p-4 text-gray-500 border border-dashed rounded-xl">
                        No tienes cursos matriculados actualmente.
                    </div>
                }
            </div>
        </section>

        <section class="bg-white rounded-2xl shadow-sm p-6 col-span-1 border border-gray-100">
            <div class="flex justify-between items-center mb-4">
                <h2 class="font-bold text-lg text-[#002940]">Calendario</h2>
            </div>
            <div class="text-center">
                <p class="font-semibold text-[#0B4D6C] mb-2">Diciembre 2025</p>
                <div class="grid grid-cols-7 gap-1 text-xs text-gray-600 font-medium">
                    <span>L</span><span>M</span><span>M</span><span>J</span><span>V</span>
                    <span class="text-red-500 font-bold">S</span><span class="text-red-500 font-bold">D</span>
                    
                    <span class="p-2 text-gray-300">29</span><span class="p-2 text-gray-300">30</span>
                    <span class="p-2 hover:bg-blue-50 rounded cursor-pointer">1</span>
                    <span class="p-2 hover:bg-blue-50 rounded cursor-pointer">2</span>
                    <span class="p-2 hover:bg-blue-50 rounded cursor-pointer">3</span>
                    <span class="p-2 hover:bg-blue-50 rounded cursor-pointer">4</span>
                    <span class="p-2 hover:bg-blue-50 rounded cursor-pointer">5</span>
                    <span class="p-2 bg-[#0B4D6C] text-white rounded-full shadow-md font-bold">8</span> 
                    <span class="p-2 hover:bg-blue-50 rounded cursor-pointer">9</span>
                    <span class="p-2 hover:bg-blue-50 rounded cursor-pointer">10</span>
                    <span class="p-2 border border-red-300 rounded text-red-500 font-bold" title="Examen">11</span>
                    <span class="p-2 hover:bg-blue-50 rounded cursor-pointer">12</span>
                </div>
            </div>
        </section>

        <section class="bg-white rounded-2xl shadow-sm p-6 col-span-1 border border-gray-100">
            <div class="flex justify-between items-center mb-4">
                <h2 class="font-bold text-lg text-[#002940]">Próximas Clases</h2>
            </div>
            <div class="space-y-3">
                @if (data.proximasClases && data.proximasClases.length > 0) {
                    @for (clase of data.proximasClases; track $index) {
                        <div [class]="clase.esVirtual ? 'border-yellow-500' : 'border-[#0B4D6C]'" 
                             class="flex gap-3 items-start border-l-4 pl-3 py-1 bg-gray-50 rounded-r-lg">
                            <div>
                                <p class="text-xs text-gray-500 font-bold uppercase">{{ clase.horario }}</p>
                                <p class="font-semibold text-sm">{{ clase.curso }}</p>
                                <span class="text-[10px] bg-gray-200 px-1.5 rounded text-gray-600">
                                    <i class="fa-solid fa-location-dot mr-1"></i>{{ clase.aula }}
                                </span>
                            </div>
                        </div>
                    }
                } @else {
                    <p class="text-gray-500 text-sm italic">No hay clases próximas.</p>
                }
            </div>
        </section>

        <section class="bg-white rounded-2xl shadow-sm p-6 border border-gray-100 col-span-1 md:col-span-2">
            <div class="flex justify-between items-center mb-4">
                <h2 class="font-bold text-lg text-[#002940]">Estado de Cuenta</h2>
                <a href="/estudiante/pagos" class="text-sm font-semibold text-[#0B4D6C] hover:underline">Detalle</a>
            </div>
            
            @if (data.estadoCuenta) {
                @if (data.estadoCuenta.tieneDeuda) {
                    <div class="flex items-center justify-between p-4 border border-red-100 bg-red-50 rounded-xl">
                        <div class="flex items-center gap-3">
                            <div class="h-10 w-10 rounded-full bg-red-100 text-red-600 flex items-center justify-center">
                                <i class="fa-solid fa-triangle-exclamation"></i>
                            </div>
                            <div>
                                <p class="font-semibold text-gray-800">{{ data.estadoCuenta.concepto }}</p>
                                <p class="text-xs text-red-500 font-bold">Vence: {{ data.estadoCuenta.vencimiento }}</p>
                            </div>
                        </div>
                        <div class="text-right">
                            <p class="text-xl font-bold text-[#002940]">S/ {{ data.estadoCuenta.monto | number:'1.2-2' }}</p>
                            <button class="text-xs bg-[#0B4D6C] text-white px-3 py-1 rounded hover:bg-[#002940] transition mt-1">Pagar</button>
                        </div>
                    </div>
                } @else {
                    <div class="flex items-center gap-3 p-4 bg-green-50 border border-green-100 rounded-xl text-green-700">
                        <i class="fa-solid fa-check-circle text-xl"></i>
                        <p class="font-bold">¡Estás al día en tus pagos!</p>
                    </div>
                }
            } @else {
                <p class="text-gray-400">Cargando información financiera...</p>
            }
        </section>

    </div>}
</div>